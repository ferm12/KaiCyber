/**
 * Type definitions for vulnerability data model
 */

export type Severity = 'critical' | 'high' | 'medium' | 'low' | 'unknown';

export type KaiStatus = 
  | 'invalid - norisk' 
  | 'ai-invalid-norisk' 
  | 'valid' 
  | 'ai-valid' 
  | string;

export interface RiskFactor {
  [key: string]: Record<string, never>;
}

export interface Vulnerability {
  cve: string;
  severity: Severity;
  cvss: number;
  status: string;
  cause: string;
  description: string;
  vecStr: string;
  exploit: string;
  riskFactors: RiskFactor;
  link: string;
  type: string;
  packageName: string;
  packageVersion: string;
  packageType: string;
  layerTime: string;
  published: string;
  fixDate: string;
  applicableRules: string[];
  owner: string;
  advisoryType: string;
  path: string;
  kaiStatus?: KaiStatus;
}

export interface Image {
  name: string;
  version: string;
  baseImage: string;
  buildType: string;
  maintainer: string;
  createTime: string;
  vulnerabilities: Vulnerability[];
}

export interface Repo {
  name: string;
  images: Record<string, Image>;
}

export interface Group {
  name: string;
  repos: Record<string, Repo>;
}

export interface VulnerabilityData {
  name: string;
  groups: Record<string, Group>;
}

export interface ProcessedVulnerability extends Vulnerability {
  id: string;
  groupName: string;
  repoName: string;
  imageName: string;
  imageVersion: string;
  publishedDate: string | null; // ISO string for Redux serialization
  fixDateParsed: string | null; // ISO string for Redux serialization
}

export interface FilterState {
  searchQuery: string;
  severity: Severity[];
  kaiStatus: KaiStatus[];
  packageName: string;
  cve: string;
  minCvss: number;
  maxCvss: number;
  dateRange: {
    start: string | null; // ISO string for Redux serialization
    end: string | null; // ISO string for Redux serialization
  };
  excludeInvalidNorisk: boolean;
  excludeAiInvalidNorisk: boolean;
}

export interface DashboardMetrics {
  totalVulnerabilities: number;
  criticalCount: number;
  highCount: number;
  mediumCount: number;
  lowCount: number;
  averageCvss: number;
  vulnerabilitiesWithFix: number;
  uniquePackages: number;
  uniqueCves: number;
}

export interface ChartData {
  labels: string[];
  datasets: {
    label: string;
    data: number[];
    backgroundColor?: string | string[];
    borderColor?: string | string[];
    borderWidth?: number;
    fill?: boolean;
    tension?: number;
  }[];
}

